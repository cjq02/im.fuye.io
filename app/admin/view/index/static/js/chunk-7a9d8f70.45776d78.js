(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a9d8f70"],{"0792":function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return s}));var n=i("61f7");function r(e,t,i){if(t){if(!Object(n["f"])(t)&&!Object(n["e"])(t))return i(new Error("号码填写不正确"));i()}else i()}function s(e,t,i){if(t){if(!Object(n["d"])(t))return i(new Error("数字填写不正确"));i()}else i()}},"0e58":function(e,t,i){},"4f57":function(e,t,i){"use strict";i("61db")},"61db":function(e,t,i){},"7c55":function(e,t,i){"use strict";i("0e58")},"9ed6":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"login-container",style:{"background-image":e.calcBackground()}},[i("div",{staticClass:"login-box"},[i("div",{staticClass:"title-container",class:e.config.attach_url?"":"hide-title"},[i("img",{staticClass:"avatar",attrs:{src:e.calcLogo(e.config)}}),e._v(" "),i("span",{staticClass:"title"},[e._v(e._s(e.config.sys_name?e.config.sys_name:"sunphp"))])]),e._v(" "),"login"==e.status?i("el-form",{ref:"form",staticClass:"login-form",attrs:{model:e.form,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[i("el-form-item",{attrs:{prop:"name"}},[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"user"}})],1),e._v(" "),i("el-input",{ref:"name",attrs:{placeholder:"账号",name:"name",type:"text",tabindex:"1",autocomplete:"on"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-tooltip",{attrs:{content:"请输入密码",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[i("el-form-item",{attrs:{prop:"pwd"}},[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),i("el-input",{key:e.pwdType,ref:"pwd",attrs:{type:e.pwdType,placeholder:"密码",name:"pwd",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:[function(t){return e.checkCapslock(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}]},model:{value:e.form.pwd,callback:function(t){e.$set(e.form,"pwd",t)},expression:"form.pwd"}}),e._v(" "),i("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[i("svg-icon",{attrs:{"icon-class":"pwd"===e.pwdType?"eye":"eye-open"}})],1)],1)],1),e._v(" "),1==e.config.register?i("div",{staticClass:"div-three"},[i("el-link",{staticClass:"item",attrs:{type:"primary"},on:{click:e.tabRegister}},[e._v("注册账号")]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请联系管理员找回密码",placement:"right-start"}},[i("el-link",{attrs:{underline:!1}},[e._v("忘记密码")])],1)],1):e._e(),e._v(" "),i("el-button",{staticStyle:{width:"100%","margin-bottom":"40px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登录")])],1):e._e(),e._v(" "),"register"==e.status?i("el-form",{ref:"formTwo",staticClass:"login-form",attrs:{"label-position":"right","label-width":"65px",model:e.form_register,rules:e.loginRules}},[i("el-form-item",{attrs:{label:"账号",prop:"name"}},[i("el-input",{ref:"reg_name",attrs:{placeholder:"账号"},model:{value:e.form_register.name,callback:function(t){e.$set(e.form_register,"name",t)},expression:"form_register.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[i("el-input",{ref:"reg_pwd",attrs:{type:"password",placeholder:"密码"},model:{value:e.form_register.pwd,callback:function(t){e.$set(e.form_register,"pwd",t)},expression:"form_register.pwd"}})],1),e._v(" "),1==e.config.bind_phone?i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{attrs:{placeholder:"手机号"},model:{value:e.form_register.phone,callback:function(t){e.$set(e.form_register,"phone",t)},expression:"form_register.phone"}})],1):e._e(),e._v(" "),i("div",{staticClass:"div-three"},[i("el-link",{staticClass:"item",attrs:{type:"primary"},on:{click:e.tabLogin}},[e._v("立即登陆")]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请联系管理员找回密码",placement:"right-start"}},[i("el-link",{attrs:{underline:!1}},[e._v("忘记密码")])],1)],1),e._v(" "),i("el-button",{staticStyle:{width:"100%","margin-bottom":"40px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleRegister(t)}}},[e._v("注册")])],1):e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"滑动验证",visible:e.is_slide,width:"350px"},on:{"update:visible":function(t){e.is_slide=t}}},[i("el-form",{ref:"formSlide",staticStyle:{width:"320px","margin-left":"5px"},attrs:{"label-position":"left","label-width":"80px"}},[i("div",[i("sun-slide",{on:{resSlide:e.resSlide}})],1)])],1),e._v(" "),i("sun-footer")],1)},r=[],s=(i("8e6e"),i("ac6a"),i("456d"),i("7f7f"),i("a481"),i("ade3")),o=i("2f62"),c=i("8828"),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"sun-slide"},[i("slide-verify",{ref:"slideblock",attrs:{l:42,r:10,w:300,h:180,imgs:e.imgs,accuracy:e.accuracy,"slider-text":e.text},on:{again:e.onAgain,fulfilled:e.onFulfilled,success:e.onSuccess,fail:e.onFail,refresh:e.onRefresh}}),e._v(" "),i("div",{staticClass:"msg-tip"},[e._v(e._s(e.msg))])],1)},l=[];function u(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?u(Object(i),!0).forEach((function(t){Object(s["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var d={name:"SunSlide",components:{},data:function(){return{msg:"",text:"向右滑",accuracy:5}},computed:f(f({},Object(o["c"])({config:function(e){return e.system.config}})),{},{imgs:function(){return[this.config.web_url+"/attachment/images/slide/bg.jpg",this.config.web_url+"/attachment/images/slide/bg1.jpg",this.config.web_url+"/attachment/images/slide/bg2.jpg",this.config.web_url+"/attachment/images/slide/bg3.jpg",this.config.web_url+"/attachment/images/slide/bg4.jpg",this.config.web_url+"/attachment/images/slide/bg5.jpg"]}}),methods:{onSuccess:function(){var e=this;this.msg="验证通过",setTimeout((function(){e.$emit("resSlide",{}),e.handleClick()}),1e3)},onFail:function(){this.msg=""},onRefresh:function(){this.msg=""},onFulfilled:function(){},onAgain:function(){this.msg="请重试",this.$refs.slideblock.reset()},handleClick:function(){this.msg="",this.$refs.slideblock.reset()}}},p=d,g=(i("4f57"),i("2877")),m=Object(g["a"])(p,a,l,!1,null,"5b1200a0",null),h=m.exports,b=i("0792"),_=i("61f7");function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function w(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){Object(s["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var y={name:"Login",components:{SunFooter:c["a"],SunSlide:h},data:function(){return{is_slide:!1,slide_check:!1,status:"login",form:{name:"",pwd:""},form_register:{name:"",pwd:"",phone:"",code:""},loginRules:{name:[{required:!0,trigger:"blur",message:"账号不能为空"}],pwd:[{required:!0,trigger:"blur",message:"密码不能为空"}],phone:[{required:!0,trigger:"blur",message:"手机号不能为空"},{validator:b["b"],trigger:"blur"}],code:[{required:!0,trigger:"blur",message:"图形码不能为空"}]},pwdType:"password",capsTooltip:!1,loading:!1,showDialog:!1,redirect:void 0,otherQuery:{}}},computed:w({},Object(o["c"])({config:function(e){return e.system.config}})),watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},created:function(){},mounted:function(){this.login_focus()},destroyed:function(){},methods:{calcLogo:function(e){return e.sys_logo?this.config.attach_url+e.sys_logo:this.config.web_url+"/attachment/logo.png"},calcBackground:function(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(e<768){if(this.config.img_mobile)return"url("+this.config.attach_url+this.config.img_mobile+")"}else if(this.config.img_web)return"url("+this.config.attach_url+this.config.img_web+")";return""},checkCapslock:function(e){var t=e.key;this.capsTooltip=t&&1===t.length&&t>="A"&&t<="Z"},showPwd:function(){var e=this;"password"===this.pwdType?this.pwdType="":this.pwdType="password",this.$nextTick((function(){e.$refs.pwd.focus()}))},handleLogin:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,e.$store.dispatch("user/login",e.form).then((function(){var t=decodeURIComponent(e.redirect).substring(1);Object(_["g"])(t)?window.location.replace(t):e.$router.push({path:e.redirect||"/",query:e.otherQuery}),e.loading=!1})).catch((function(){e.loading=!1}))}))},login_focus:function(){""===this.form.name?this.$refs.name.focus():""===this.form.pwd&&this.$refs.pwd.focus()},reg_focus:function(){""===this.form_register.name?this.$refs.reg_name.focus():""===this.form_register.pwd&&this.$refs.reg_pwd.focus()},tabLogin:function(){var e=this;this.form={name:"",pwd:""},this.status="login",this.slide_check=!1,this.$nextTick((function(){e.login_focus()}))},tabRegister:function(){var e=this;this.form_register={name:"",pwd:"",phone:"",code:""},this.status="register",this.slide_check=!1,this.$nextTick((function(){e.reg_focus()}))},resSlide:function(){this.is_slide=!1,this.slide_check=!0,this.handleRegister()},handleRegister:function(){var e=this;this.$refs.formTwo.validate((function(t){if(!t)return!1;e.slide_check?(e.loading=!0,e.$http.post("user/register",e.form_register).then((function(t){e.$notify({title:"成功",message:t.message,type:"success",duration:2e3}),e.loading=!1,e.tabLogin()})).catch((function(){e.loading=!1})).finally((function(){e.slide_check=!1}))):e.is_slide=!0}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,i){return"redirect"!==i&&(t[i]=e[i]),t}),{})}}},k=y,O=(i("7c55"),i("cd3d"),Object(g["a"])(k,n,r,!1,null,"3160aa02",null));t["default"]=O.exports},ab3a:function(e,t,i){},cd3d:function(e,t,i){"use strict";i("ab3a")}}]);